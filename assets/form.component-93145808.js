import{j as R}from"./jsx-runtime-91a467a5.js";import{f as A}from"./index-14b03c13.js";import{i as B,a as N}from"./FormBuilder-1c4b949e.js";import{P as e}from"./index-1fc0ca9a.js";import{c as y}from"./cloneDeep-ce19361f.js";import{r as s}from"./index-8db94870.js";function t(n,r,a){s.useEffect(()=>{r&&a.set(n,r)},[r,n,a])}function j(n){const r=s.useRef(new Map),a=o=>n.hasOwnProperty(o)&&typeof n[o]=="function",d=(o,...l)=>{if(a(o))return(r.current.has(o)?r.current.get(o):n[o])(...l)};return t("onBlur",n.onBlur,r.current),t("onPrevPage",n.onPrevPage,r.current),t("onNextPage",n.onNextPage,r.current),t("onCancel",n.onCancel,r.current),t("onChange",n.onChange,r.current),t("onCustomEvent",n.onCustomEvent,r.current),t("onComponentChange",n.onComponentChange,r.current),t("onSubmit",n.onSubmit,r.current),t("onAsyncSubmit",n.onAsyncSubmit,r.current),t("onSubmitDone",n.onSubmitDone,r.current),t("onFormLoad",n.onFormLoad,r.current),t("onError",n.onError,r.current),t("onRender",n.onRender,r.current),t("onAttach",n.onAttach,r.current),t("onBuild",n.onBuild,r.current),t("onFocus",n.onFocus,r.current),t("onBlur",n.onBlur,r.current),t("onInitialized",n.onInitialized,r.current),{events:r,emit:d,hasEvent:a}}function v(n){const{src:r,form:a,options:d={},submission:o,url:l,...g}=n,C=s.useRef(),h=s.useRef(),u=s.useRef(),{emit:b,hasEvent:S}=j(g);async function F(c,i){if(S("onAsyncSubmit"))try{await b("onAsyncSubmit",c,u.current)}catch(m){i((m==null?void 0:m.errors)||m)}else i(null)}const E=(c,i)=>{var m;return i=Object.assign({},i),c=typeof c=="string"?c:y(c),u.current||(h.current=!1,i.hooks={...i.hooks||{},customValidation:((m=i==null?void 0:i.hooks)==null?void 0:m.customValidation)||F},u.current=new A.Form(C.current,c,i),u.current.onAny((f,...p)=>{if(u.current&&f.startsWith("formio.")){const P=`on${f.charAt(7).toUpperCase()}${f.slice(8)}`;if(P==="onChange"&&!p[0].changed)return;b(P,...p,u.current)}}),u.current.ready.then(f=>{o&&(f.submission=y(o)),n.onFormReady&&n.onFormReady(f),h.current=!0})),u.current};return s.useEffect(()=>{u.current&&u.current.ready.then(c=>{B(c.submission.data,o==null?void 0:o.data)||o&&(c.submission=y(o))})},[o]),s.useEffect(()=>{a&&u.current&&u.current.ready.then(c=>{c.form=a,l&&(c.url=l)})},[a,l]),s.useEffect(()=>{r&&(u.current&&(h.current=!1,u.current.destroy(!0)),E(r,d))},[r]),s.useEffect(()=>(a&&E(a,d),()=>{h.current=!1,u.current&&u.current.destroy(!0)}),[]),{element:C}}A.Components.setComponents(N);function x(n){const{element:r}=v(n);return R("div",{"data-testid":`formioContainer${n.name||""}`,ref:r,className:n.className})}x.propTypes={name:e.string,className:e.string,src:e.string,url:e.string,form:e.object,submission:e.object,options:e.shape({readOnly:e.bool,noAlerts:e.bool,i18n:e.any,template:e.string,saveDraft:e.bool,hooks:e.any}),onPrevPage:e.func,onNextPage:e.func,onCancel:e.func,onChange:e.func,onCustomEvent:e.func,onComponentChange:e.func,onSubmit:e.func,onAsyncSubmit:e.func,onSubmitDone:e.func,onFormLoad:e.func,onError:e.func,onRender:e.func,onAttach:e.func,onBuild:e.func,onFocus:e.func,onBlur:e.func,onInitialized:e.func,onFormReady:e.func,formioform:e.any};export{x as F};
//# sourceMappingURL=form.component-93145808.js.map
