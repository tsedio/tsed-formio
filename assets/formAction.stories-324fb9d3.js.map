{"version":3,"file":"formAction.stories-324fb9d3.js","sources":["../../../react-formio/src/components/form-action/formAction.component.tsx"],"sourcesContent":["import FormioUtils from \"formiojs/utils\";\nimport React, { PropsWithChildren, ReactElement } from \"react\";\n\nimport { ActionDefaultsSchema, ActionSchema, FormOptions, Submission } from \"../../interfaces\";\nimport { Form } from \"../form/form.component\";\n\nfunction mapData(options: any, defaults: ActionDefaultsSchema): any {\n  return {\n    ...defaults,\n    ...options\n  };\n}\n\nfunction mapSettingsForm({ action, ...settingsForm }: any): any {\n  FormioUtils.eachComponent(settingsForm.components, (component: any) => {\n    const resourceExclude = \"\";\n\n    if (component.type === \"resourcefields\") {\n      component.type = \"select\";\n      component.label = component.title;\n      component.dataSrc = \"url\";\n      component.data = {\n        url: `${component.basePath}?type=resource${resourceExclude}`\n      };\n      component.valueProperty = \"_id\";\n      component.template = \"<span>{{ item.title }}</span>\";\n      component.persistent = true;\n    }\n  });\n\n  return settingsForm;\n}\n\nexport interface FormActionProps {\n  actionInfo: Partial<ActionSchema>;\n  submission?: Partial<Submission>;\n  onSubmit?: (submission: Submission<ActionSchema>) => void;\n  options: FormOptions;\n}\n\nexport function FormAction({ actionInfo, children, onSubmit, options, ...props }: PropsWithChildren<FormActionProps>): ReactElement {\n  const { form, submission } = (() => {\n    const submission = mapData(props.submission || {}, actionInfo.defaults!);\n    const form = mapSettingsForm(actionInfo.settingsForm);\n\n    return { form, submission: { data: submission } };\n  })();\n\n  return (\n    <div>\n      {children}\n\n      <Form form={form} submission={submission} onSubmit={onSubmit} options={options} />\n\n      {children}\n    </div>\n  );\n}\n"],"names":["mapData","options","defaults","mapSettingsForm","action","settingsForm","FormioUtils","component","resourceExclude","FormAction","actionInfo","children","onSubmit","props","form","submission","jsx","Form"],"mappings":"kbAMA,SAASA,EAAQC,EAAcC,EAAqC,CAC3D,MAAA,CACL,GAAGA,EACH,GAAGD,CAAA,CAEP,CAEA,SAASE,EAAgB,CAAE,OAAAC,EAAQ,GAAGC,GAA0B,CAC9DC,OAAAA,EAAY,cAAcD,EAAa,WAAaE,GAAmB,CACrE,MAAMC,EAAkB,GAEpBD,EAAU,OAAS,mBACrBA,EAAU,KAAO,SACjBA,EAAU,MAAQA,EAAU,MAC5BA,EAAU,QAAU,MACpBA,EAAU,KAAO,CACf,IAAK,GAAGA,EAAU,yBAAyBC,GAAA,EAE7CD,EAAU,cAAgB,MAC1BA,EAAU,SAAW,gCACrBA,EAAU,WAAa,GACzB,CACD,EAEMF,CACT,CASgB,SAAAI,EAAW,CAAE,WAAAC,EAAY,SAAAC,EAAU,SAAAC,EAAU,QAAAX,EAAS,GAAGY,GAA2D,CAClI,KAAM,CAAE,KAAAC,EAAM,WAAAC,CAAW,GAAK,IAAM,CAClC,MAAMA,EAAaf,EAAQa,EAAM,YAAc,GAAIH,EAAW,QAAS,EAGvE,MAAO,CAAE,KAFIP,EAAgBO,EAAW,YAAY,EAErC,WAAY,CAAE,KAAMK,GAAa,KAGlD,SACG,MACE,CAAA,SAAA,CAAAJ,EAEAK,EAAAC,EAAA,CAAK,KAAAH,EAAY,WAAAC,EAAwB,SAAAH,EAAoB,QAAAX,EAAkB,EAE/EU,CACH,CAAA,CAAA,CAEJ;;;;"}