{"version":3,"file":"formSettings.stories-7bdc7388.js","sources":["../../../react-formio/src/components/form-settings/formSettings.schema.ts","../../../react-formio/src/components/form-settings/formSettings.utils.ts","../../../react-formio/src/components/form-settings/formSettings.component.tsx"],"sourcesContent":["import { FormSchema } from \"../../interfaces\";\n\nexport function getFormSettingsSchema(): FormSchema {\n  return {\n    type: \"form\",\n    tags: [],\n    components: [\n      {\n        input: true,\n        key: \"action\",\n        placeholder: \"Enter the custom submission URL\",\n        label: \"Custom Action Url\",\n        labelPosition: \"top\",\n        widget: { type: \"input\" },\n        type: \"url\",\n        mask: false,\n        inputType: \"url\",\n        inputFormat: \"plain\",\n        spellcheck: true,\n        id: \"efyrzea\",\n        attributes: {\n          \"data-testid\": \"action\"\n        }\n      },\n      {\n        input: true,\n        key: \"tags\",\n        placeholder: \"Add tags\",\n        label: \"Form tags\",\n        widget: { type: \"input\" },\n        type: \"tags\",\n        delimeter: \",\",\n        storeas: \"array\",\n        maxTags: 0,\n        id: \"erxcyw\"\n      },\n      {\n        input: true,\n        key: \"properties\",\n        label: \"Custom Properties\",\n        labelPosition: \"top\",\n        type: \"datamap\",\n        addAnother: \"Add Another\",\n        disableAddingRemovingRows: false,\n        keyBeforeValue: true,\n        valueComponent: {\n          type: \"textfield\",\n          key: \"value\",\n          label: \"Value\",\n          input: true,\n          hideLabel: true\n        },\n        id: \"ezne35\"\n      }\n    ],\n    display: \"form\"\n  };\n}\n","import cloneDeep from \"lodash/cloneDeep\";\n\nimport { FormSchema, Submission } from \"../../interfaces\";\n\nexport type FormSettingsSchema = {\n  action: string;\n  tags: string[];\n  properties: Record<string, any>;\n};\n\nexport function formSettingsToSubmission(form: Partial<FormSchema>): Submission<FormSettingsSchema> {\n  return {\n    data: {\n      action: form.action!,\n      tags: form.tags!,\n      properties: form.properties!\n    }\n  };\n}\n\nexport function submissionToFormSettings(form: Partial<FormSchema>, submission: Submission<FormSettingsSchema>): Partial<FormSchema> {\n  return {\n    ...cloneDeep(form),\n    tags: submission.data.tags,\n    action: submission.data.action,\n    properties: submission.data.properties\n  };\n}\n","import isEqual from \"lodash/isEqual\";\nimport noop from \"lodash/noop\";\nimport React, { useEffect, useState } from \"react\";\n\nimport { FormOptions, FormSchema } from \"../../interfaces\";\nimport { Form } from \"../form/form.component\";\nimport { ChangedSubmission } from \"../form/useForm.hook\";\nimport { getFormSettingsSchema } from \"./formSettings.schema\";\nimport { FormSettingsSchema, formSettingsToSubmission, submissionToFormSettings } from \"./formSettings.utils\";\n\nexport interface FormSettingsProps {\n  form: Partial<FormSchema>;\n  onSubmit?: Function;\n  options?: FormOptions;\n}\n\nfunction useFormSettings({ form: formDefinition, onSubmit = noop, options }: FormSettingsProps) {\n  const form = getFormSettingsSchema();\n  const [isValid, setIsValid] = useState(true);\n  const [submission, setSubmission] = useState(() => formSettingsToSubmission(formDefinition));\n\n  const onChange = ({ data, isValid }: ChangedSubmission<FormSettingsSchema>) => {\n    if (isValid) {\n      setSubmission({ data });\n    }\n    setIsValid(isValid);\n  };\n\n  useEffect(() => {\n    const input = formSettingsToSubmission(formDefinition);\n    if (formDefinition?._id && !isEqual(submission.data, input.data)) {\n      setSubmission(input);\n    }\n  }, [formDefinition?._id]);\n\n  return {\n    options,\n    form,\n    type: formDefinition.type,\n    submission,\n    onChange,\n    isValid,\n    setIsValid,\n    onSubmit: () => {\n      onSubmit(submissionToFormSettings(formDefinition, submission));\n    }\n  };\n}\n\nexport function FormSettings(props: FormSettingsProps) {\n  const { form, submission, options = {}, onChange, onSubmit, isValid } = useFormSettings(props);\n\n  const i18n = options.i18n || ((f: string) => f);\n\n  return (\n    <div>\n      <Form form={form} submission={submission} onChange={onChange} options={options} />\n\n      <button data-testid='submit' disabled={!isValid} className={\"mt-5 btn btn-primary\"} onClick={onSubmit} type={\"submit\"}>\n        {i18n(\"Save settings\")}\n      </button>\n    </div>\n  );\n}\n"],"names":["getFormSettingsSchema","formSettingsToSubmission","form","submissionToFormSettings","submission","cloneDeep","useFormSettings","formDefinition","onSubmit","noop","options","isValid","setIsValid","useState","setSubmission","onChange","data","useEffect","input","isEqual","FormSettings","props","i18n","f","jsx","Form"],"mappings":"ifAEO,SAASA,GAAoC,CAC3C,MAAA,CACL,KAAM,OACN,KAAM,CAAC,EACP,WAAY,CACV,CACE,MAAO,GACP,IAAK,SACL,YAAa,kCACb,MAAO,oBACP,cAAe,MACf,OAAQ,CAAE,KAAM,OAAQ,EACxB,KAAM,MACN,KAAM,GACN,UAAW,MACX,YAAa,QACb,WAAY,GACZ,GAAI,UACJ,WAAY,CACV,cAAe,QACjB,CACF,EACA,CACE,MAAO,GACP,IAAK,OACL,YAAa,WACb,MAAO,YACP,OAAQ,CAAE,KAAM,OAAQ,EACxB,KAAM,OACN,UAAW,IACX,QAAS,QACT,QAAS,EACT,GAAI,QACN,EACA,CACE,MAAO,GACP,IAAK,aACL,MAAO,oBACP,cAAe,MACf,KAAM,UACN,WAAY,cACZ,0BAA2B,GAC3B,eAAgB,GAChB,eAAgB,CACd,KAAM,YACN,IAAK,QACL,MAAO,QACP,MAAO,GACP,UAAW,EACb,EACA,GAAI,QACN,CACF,EACA,QAAS,MAAA,CAEb,CC/CO,SAASC,EAAyBC,EAA2D,CAC3F,MAAA,CACL,KAAM,CACJ,OAAQA,EAAK,OACb,KAAMA,EAAK,KACX,WAAYA,EAAK,UACnB,CAAA,CAEJ,CAEgB,SAAAC,EAAyBD,EAA2BE,EAAiE,CAC5H,MAAA,CACL,GAAGC,EAAUH,CAAI,EACjB,KAAME,EAAW,KAAK,KACtB,OAAQA,EAAW,KAAK,OACxB,WAAYA,EAAW,KAAK,UAAA,CAEhC,CCXA,SAASE,EAAgB,CAAE,KAAMC,EAAgB,SAAAC,EAAWC,EAAM,QAAAC,GAA8B,CAC9F,MAAMR,EAAOF,IACP,CAACW,EAASC,CAAU,EAAIC,WAAS,EAAI,EACrC,CAACT,EAAYU,CAAa,EAAID,WAAS,IAAMZ,EAAyBM,CAAc,CAAC,EAErFQ,EAAW,CAAC,CAAE,KAAAC,EAAM,QAAAL,KAAqD,CACzEA,GACYG,EAAA,CAAE,KAAAE,EAAM,EAExBJ,EAAWD,CAAO,CAAA,EAGpBM,OAAAA,EAAAA,UAAU,IAAM,CACR,MAAAC,EAAQjB,EAAyBM,CAAc,EACjDA,GAAA,MAAAA,EAAgB,KAAO,CAACY,EAAQf,EAAW,KAAMc,EAAM,IAAI,GAC7DJ,EAAcI,CAAK,CACrB,EACC,CAACX,GAAA,YAAAA,EAAgB,GAAG,CAAC,EAEjB,CACL,QAAAG,EACA,KAAAR,EACA,KAAMK,EAAe,KACrB,WAAAH,EACA,SAAAW,EACA,QAAAJ,EACA,WAAAC,EACA,SAAU,IAAM,CACLJ,EAAAL,EAAyBI,EAAgBH,CAAU,CAAC,CAC/D,CAAA,CAEJ,CAEO,SAASgB,EAAaC,EAA0B,CAC/C,KAAA,CAAE,KAAAnB,EAAM,WAAAE,EAAY,QAAAM,EAAU,CAAI,EAAA,SAAAK,EAAU,SAAAP,EAAU,QAAAG,CAAA,EAAYL,EAAgBe,CAAK,EAEvFC,EAAOZ,EAAQ,OAAUa,GAAcA,GAE7C,SACG,MACC,CAAA,SAAA,CAAAC,EAACC,EAAK,CAAA,KAAAvB,EAAY,WAAAE,EAAwB,SAAAW,EAAoB,QAAAL,EAAkB,EAE/Ec,EAAA,SAAA,CAAO,cAAY,SAAS,SAAU,CAACb,EAAS,UAAW,uBAAwB,QAASH,EAAU,KAAM,SAC1G,SAAAc,EAAK,eAAe,EACvB,CACF,CAAA,CAAA,CAEJ;;;"}